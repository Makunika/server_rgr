# Серверная часть для приложения Bolt Drive

Сервер представляет собой многопоточное приложение, которое в зависимости от запроса отпраляет ответ. Юзеров хранит в бд, а файлы пользовтаеля на жестком диске. Можно задать для сохранения FTP сервер

##Собственный протокол, по которому работает сервер

Протокол прикладного работает по принципу «запрос – ответ» как http. При получении запроса скачать-закачать файл не создает новое соединение, а использует для передачи уже существующее, после которого отключается.

В общем случае строка запроса данного протокола выглядит так:

*<user>/<password>://<Текстовая расшифровка запроса> /<Данные для сервера (путь к папке,размер нового файла)>://<Код запроса>*

Если данных для сервера много, то они разделяются с помощью двух символов .

Пример запроса:

*Maxim/12345://NEWPATH /\data\lang\//de://204*

Мы посылаем запрос на создание новой папки в папке с названием для пользователя с логином и паролем . Код данного запроса 204.

У каждого запроса есть собственный код:

- 100 – REGISTRATION – регистрация нового пользователя. Необходимо передать email в поле .
- 101 – AUTHORIZATION – авторизация пользователя.
- 200 – UPLOAD – загрузка на сервер файла или папки. Необходимо передать путь и размер в байтах в поле
- 201 – LOAD – загрузка с сервера файла или папки. Необходимо передать путь в поле
- 202 – RENAME – переименование файла или папки. Необходимо передать путь в поле
- 203 – RELOCATE – перемещение на сервере файла или папки в другую папку. Необходимо передать путь в поле
- 204 – NEWPATH – создание новой папки. Необходимо передать путь в поле
- 205 – DELETE – удаление файла или папки. Необходимо передать путь в поле .
- 300 – REMPASS – Восстановить пароль. Необходимо передать email в поле .

Ответ сервера на запрос выглядит следующим образом:

*<user>/<password>://<Текстовая расшифровка запроса>://<Данные для клиента или текстовая расшифровка ответа>://<Код ответа>*

Пример ответа:

*Maxim/12345://NEWPATH://CreateDir successful://204*

Если ответ успешный, то код ответа совпадает с кодом запроса, если же ответ не успешный, то код ответа выглядит как , где – первая цифра запроса, а – код ошибки этого запроса.

Стоит отметить, что при запросе 101, то есть авторизации, сервер при успешном ответе посылает в поле дерево папок и файлов данного клиента на сервере.
